---
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import placeHolderImage from "@/images/placeholder.svg";
import { ArrowRight } from "@lucide/astro";
import Layout from "@/layouts/layout.astro";
import Hero from "@/components/ui/hero.astro";
import {
  Card,
  CardHeader,
  CardTitle,
  CardContent,
  CardFooter,
  CardAction,
} from "@/components/ui/card";

const blogCollection: CollectionEntry<"blogs">[] = (
  await getCollection("blogs")
)
  .filter((post) => !post.data.draft)
  .sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime())
  .slice(0, 3);
---

<Layout title="Home Page">
  <Hero
    title="Build better learn faster"
    description="All the resources you need for Frontend."
    features={["React", "Next.js", "Astro"]}
  />

  <div>
    <h2 class="heading-section mb-6 md:mb-8">Astro</h2>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
      <div class="basis-1/4">
        <p>
          Astro is a modern static site builder that makes it easy to create
          fast, content-focused websites.
        </p>
      </div>
      {
        blogCollection.map((blog) => (
          <a href={`/blogs/${blog.slug}`} class="group">
          <Card class="h-full">
            <CardHeader class="flex flex-col-reverse gap-4">
              <CardTitle class="px-4">{blog.data.title}</CardTitle>
              <div class="relative overflow-hidden">
                <Image
                  src={blog.data.image ?? placeHolderImage}
                  alt={blog.data.title}
                  densities={[1.5, 2]}
                  class="object-cover w-full h-full aspect-4/3 md:aspect-video group-hover:scale-105 transition-transform duration-300"
                  loading="lazy"
                />
              </div>
            </CardHeader>
            <CardContent class="px-4">
              <p>
                {blog.data.description}
              </p>
            </CardContent>
            <CardFooter class="px-4 pb-4 mt-auto">
              <CardAction class="ml-auto">
                <ArrowRight class="w-5 h-5 text-muted-foreground group-hover:text-accent transition-colors" />
              </CardAction>
            </CardFooter>
          </Card>
        </a>
        ))
      }
    </div>
  </div>
</Layout>
